# å“ç‰Œç›¸æœºç³»ç»Ÿæ¶æ„å›¾

> **å¯è§†åŒ–æ¶æ„æ–‡æ¡£** - å›¾è§£é¡¹ç›®æ¶æ„

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    ç”¨æˆ·å±‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“± ç§»åŠ¨ç«¯  â”‚  â”‚  ğŸ’» æ¡Œé¢ç«¯  â”‚  â”‚  ğŸŒ PWA     â”‚  â”‚  ğŸ“Š ç®¡ç†åå° â”‚   â”‚
â”‚  â”‚  (iOS/å®‰å“) â”‚  â”‚  (æµè§ˆå™¨)   â”‚  â”‚  (ç¦»çº¿æ¨¡å¼) â”‚  â”‚  (ç®¡ç†å‘˜)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Vercel Edge Network                             â”‚
â”‚                           (å…¨çƒ CDN + è¾¹ç¼˜è®¡ç®—)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next.js å‰ç«¯    â”‚      â”‚  Serverless API  â”‚      â”‚  Middleware      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  â€¢ App Router    â”‚      â”‚  30 ä¸ª API è·¯ç”±  â”‚      â”‚  â€¢ è®¤è¯æ£€æŸ¥      â”‚
â”‚  â€¢ RSC æ”¯æŒ      â”‚â—€â”€â”€â”€â”€â–¶â”‚  â€¢ æœ€é•¿ 5 åˆ†é’Ÿ   â”‚      â”‚  â€¢ Session ç®¡ç†  â”‚
â”‚  â€¢ 21 ä¸ªé¡µé¢     â”‚      â”‚  â€¢ TypeScript    â”‚      â”‚  â€¢ è·¯ç”±ä¿æŠ¤      â”‚
â”‚  â€¢ 24 ä¸ªç»„ä»¶     â”‚      â”‚  â€¢ ç±»å‹å®‰å…¨      â”‚      â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
          â”‚                      â”‚
          â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Zustand Store   â”‚      â”‚         å¤–éƒ¨æœåŠ¡é›†æˆ                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ Camera Store  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â€¢ Asset Store   â”‚      â”‚  â”‚ Google Cloud â”‚  â”‚   Supabase      â”‚ â”‚
â”‚  â€¢ Task Store    â”‚      â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â€¢ IndexedDB     â”‚      â”‚  â”‚ Gemini API:  â”‚  â”‚ â€¢ PostgreSQL    â”‚ â”‚
â”‚  æŒä¹…åŒ–           â”‚      â”‚  â”‚ â€¢ Pro Model  â”‚  â”‚ â€¢ Auth          â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚ â€¢ Flash Modelâ”‚  â”‚ â€¢ Storage       â”‚ â”‚
                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ Realtime      â”‚ â”‚
                          â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
                          â”‚  â”‚  Aliyun SMS     â”‚                   â”‚
                          â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚                   â”‚
                          â”‚  â”‚  â€¢ éªŒè¯ç å‘é€   â”‚                   â”‚
                          â”‚  â”‚  â€¢ æ‰‹æœºå·ç™»å½•   â”‚                   â”‚
                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ å‰ç«¯æ¶æ„è¯¦è§£

```
src/
â”œâ”€â”€ app/                              # Next.js 14 App Router
â”‚   â”‚
â”‚   â”œâ”€â”€ (main)/                       # ä¸»åº”ç”¨å¸ƒå±€ï¼ˆå¸¦åº•éƒ¨å¯¼èˆªï¼‰
â”‚   â”‚   â”œâ”€â”€ layout.tsx                # å¸ƒå±€ç»„ä»¶ + BottomNav
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ camera/                   # ğŸ“· ç›¸æœºæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ç›¸æœºä¸»é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ outfit/               # å¤šå•†å“æ‹æ‘„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ select/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx      # å•†å“é€‰æ‹©
â”‚   â”‚   â”‚   â”œâ”€â”€ group/                # ç»„å›¾æ‹æ‘„
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ shoot/                # æ‹æ‘„ç»“æœ
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ edit/                     # âœï¸ ç¼–è¾‘æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ç¼–è¾‘ä¸»é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ general/              # é€šç”¨ç¼–è¾‘
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ brand-assets/             # ğŸ“ å“ç‰Œèµ„äº§æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx              # ç´ æç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ gallery/                  # ğŸ–¼ï¸ å›¾åº“æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ç”Ÿæˆå†å²
â”‚   â”‚   â”‚   â””â”€â”€ modify-material/      # æè´¨ä¿®æ”¹
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ studio/                   # ğŸ¢ å•†å“å½±æ£š
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pro-studio/               # ğŸ’¼ æ¨¡ç‰¹æ£šæ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ outfit/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ admin/                    # ğŸ‘‘ ç®¡ç†åå°
â”‚   â”‚       â”œâ”€â”€ page.tsx              # ä»ªè¡¨ç›˜
â”‚   â”‚       â”œâ”€â”€ applications/         # é…é¢ç”³è¯·
â”‚   â”‚       â”œâ”€â”€ presets/              # ç´ æç®¡ç†
â”‚   â”‚       â””â”€â”€ quotas/               # é…é¢ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                          # API è·¯ç”±ï¼ˆ30ä¸ªï¼‰
â”‚   â”‚   â”œâ”€â”€ generate/                 # ç»Ÿä¸€ç”Ÿæˆå…¥å£
â”‚   â”‚   â”œâ”€â”€ generate-product/         # å•†å“å›¾ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ generate-model/           # æ¨¡ç‰¹å›¾ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ generate-single/          # å•å¼ ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ generate-studio/          # å•†å“å½±æ£š
â”‚   â”‚   â”œâ”€â”€ generate-pro-studio/      # æ¨¡ç‰¹æ£šæ‹
â”‚   â”‚   â”œâ”€â”€ generate-group/           # ç»„å›¾ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ edit/                     # å›¾ç‰‡ç¼–è¾‘
â”‚   â”‚   â”œâ”€â”€ modify-material/          # æè´¨ä¿®æ”¹
â”‚   â”‚   â”œâ”€â”€ quota/                    # é…é¢æŸ¥è¯¢
â”‚   â”‚   â”‚   â””â”€â”€ reserve/              # é…é¢é¢„ç•™
â”‚   â”‚   â”œâ”€â”€ gallery/                  # å›¾åº“æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ favorites/                # æ”¶è—ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ presets/                  # é¢„è®¾ç´ æ
â”‚   â”‚   â”œâ”€â”€ admin/                    # ç®¡ç†æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â”‚   â”œâ”€â”€ quotas/
â”‚   â”‚   â”‚   â”œâ”€â”€ downloads/
â”‚   â”‚   â”‚   â””â”€â”€ presets/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ auth/                         # è®¤è¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ callback/                 # OAuth å›è°ƒ
â”‚   â”‚   â””â”€â”€ confirm/                  # é‚®ç®±ç¡®è®¤
â”‚   â”‚
â”‚   â”œâ”€â”€ login/                        # ç™»å½•é¡µ
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                    # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ globals.css                   # å…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ components/                       # React ç»„ä»¶ï¼ˆ24ä¸ªï¼‰
â”‚   â”œâ”€â”€ ui/                           # åŸºç¡€ UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ button.tsx                # æŒ‰é’®
â”‚   â”‚   â”œâ”€â”€ card.tsx                  # å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ dialog.tsx                # å¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ progress.tsx              # è¿›åº¦æ¡
â”‚   â”‚   â”œâ”€â”€ sheet.tsx                 # åº•éƒ¨æŠ½å±‰
â”‚   â”‚   â”œâ”€â”€ tabs.tsx                  # æ ‡ç­¾é¡µ
â”‚   â”‚   â””â”€â”€ toast.tsx                 # æç¤º
â”‚   â”‚
â”‚   â”œâ”€â”€ camera/                       # ç›¸æœºæ¨¡å—ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AssetSelector.tsx         # èµ„äº§é€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ StyleSelector.tsx         # é£æ ¼é€‰æ‹©å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ providers/                    # Context Providers
â”‚   â”‚   â”œâ”€â”€ AuthProvider.tsx          # è®¤è¯ä¸Šä¸‹æ–‡
â”‚   â”‚   â””â”€â”€ StoreProvider.tsx         # çŠ¶æ€ç®¡ç†ä¸Šä¸‹æ–‡
â”‚   â”‚
â”‚   â””â”€â”€ shared/                       # å…±äº«ç»„ä»¶
â”‚       â”œâ”€â”€ BottomNav.tsx             # åº•éƒ¨å¯¼èˆª
â”‚       â”œâ”€â”€ Header.tsx                # é¡µé¢å¤´éƒ¨
â”‚       â”œâ”€â”€ LoadingSpinner.tsx        # åŠ è½½åŠ¨ç”»
â”‚       â”œâ”€â”€ QuotaIndicator.tsx        # é…é¢æŒ‡ç¤ºå™¨
â”‚       â”œâ”€â”€ VersionChecker.tsx        # ç‰ˆæœ¬æ£€æŸ¥
â”‚       â”œâ”€â”€ FlyToGallery.tsx          # é£å…¥åŠ¨ç”»
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ lib/                              # å·¥å…·åº“
â”‚   â”œâ”€â”€ genai.ts                      # â­ Gemini API å°è£…
â”‚   â”œâ”€â”€ auth.ts                       # è®¤è¯å·¥å…·
â”‚   â”œâ”€â”€ utils.ts                      # é€šç”¨å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ supabase/                     # Supabase é›†æˆ
â”‚   â”‚   â”œâ”€â”€ client.ts                 # å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ server.ts                 # æœåŠ¡ç«¯
â”‚   â”‚   â”œâ”€â”€ middleware.ts             # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ generations.ts            # ç”Ÿæˆè®°å½•ï¼ˆå®¢æˆ·ç«¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ generations-server.ts     # ç”Ÿæˆè®°å½•ï¼ˆæœåŠ¡ç«¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ generationService.ts      # ç”ŸæˆæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ storage.ts                # å­˜å‚¨ï¼ˆå®¢æˆ·ç«¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ storage-server.ts         # å­˜å‚¨ï¼ˆæœåŠ¡ç«¯ï¼‰
â”‚   â”‚   â””â”€â”€ syncService.ts            # åŒæ­¥æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ presets/
â”‚   â”‚   â””â”€â”€ serverPresets.ts          # é¢„è®¾ç´ ææœåŠ¡ç«¯
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ redirect.ts               # é‡å®šå‘å·¥å…·
â”‚
â”œâ”€â”€ stores/                           # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ cameraStore.ts                # ç›¸æœºçŠ¶æ€
â”‚   â”œâ”€â”€ assetStore.ts                 # èµ„äº§çŠ¶æ€
â”‚   â”œâ”€â”€ generationTaskStore.ts        # ä»»åŠ¡çŠ¶æ€
â”‚   â”œâ”€â”€ languageStore.ts              # è¯­è¨€çŠ¶æ€
â”‚   â”œâ”€â”€ presetStore.ts                # é¢„è®¾çŠ¶æ€
â”‚   â””â”€â”€ settingsStore.ts              # è®¾ç½®çŠ¶æ€
â”‚
â”œâ”€â”€ types/                            # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ index.ts                      # ä¸»ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ outfit.ts                     # Outfit ç±»å‹
â”‚
â”œâ”€â”€ prompts/                          # AI æç¤ºè¯æ¨¡æ¿
â”‚   â””â”€â”€ index.ts                      # æç¤ºè¯å®šä¹‰
â”‚
â”œâ”€â”€ hooks/                            # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ useQuota.ts                   # é…é¢ç®¡ç†
â”‚   â””â”€â”€ useVersionCheck.ts            # ç‰ˆæœ¬æ£€æŸ¥
â”‚
â”œâ”€â”€ locales/                          # å›½é™…åŒ–
â”‚   â”œâ”€â”€ index.ts                      # å¯¼å‡º
â”‚   â”œâ”€â”€ zh.ts                         # ä¸­æ–‡
â”‚   â”œâ”€â”€ en.ts                         # è‹±æ–‡
â”‚   â””â”€â”€ ko.ts                         # éŸ©æ–‡
â”‚
â””â”€â”€ middleware.ts                     # Next.js ä¸­é—´ä»¶
```

---

## ğŸ—„ï¸ æ•°æ®åº“æ¶æ„ï¼ˆSupabase PostgreSQLï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Supabase PostgreSQL                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  auth.users  â”‚       â”‚ generations  â”‚       â”‚ favorites â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚  id          â”‚â—€â”€â”€â”€â”€â”€â”€â”‚  user_id (FK)â”‚â—€â”€â”€â”€â”€â”€â”€â”‚ user_id   â”‚ â”‚
â”‚  â”‚  email       â”‚       â”‚  task_type   â”‚       â”‚ gen_id    â”‚ â”‚
â”‚  â”‚  phone       â”‚       â”‚  status      â”‚       â”‚ image_idx â”‚ â”‚
â”‚  â”‚  created_at  â”‚       â”‚  input_paramsâ”‚       â”‚           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  output_imgs â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚  duration_ms â”‚                      â”‚
â”‚                         â”‚  created_at  â”‚                      â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ user_quotas  â”‚       â”‚ sms_codes    â”‚       â”‚ presets   â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚  user_id (PK)â”‚       â”‚  id          â”‚       â”‚ id        â”‚ â”‚
â”‚  â”‚  daily_quota â”‚       â”‚  phone       â”‚       â”‚ type      â”‚ â”‚
â”‚  â”‚  monthly_q.  â”‚       â”‚  code        â”‚       â”‚ name      â”‚ â”‚
â”‚  â”‚  used_today  â”‚       â”‚  expires_at  â”‚       â”‚ image_url â”‚ â”‚
â”‚  â”‚  used_month  â”‚       â”‚  verified_at â”‚       â”‚ tags      â”‚ â”‚
â”‚  â”‚  reset_at    â”‚       â”‚              â”‚       â”‚ category  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ quota_applications   â”‚       â”‚  download_events         â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚  id                  â”‚       â”‚  id                      â”‚ â”‚
â”‚  â”‚  user_id             â”‚       â”‚  user_id                 â”‚ â”‚
â”‚  â”‚  requested_quota     â”‚       â”‚  generation_id           â”‚ â”‚
â”‚  â”‚  reason              â”‚       â”‚  image_index             â”‚ â”‚
â”‚  â”‚  status (pending/...)â”‚       â”‚  downloaded_at           â”‚ â”‚
â”‚  â”‚  reviewed_at         â”‚       â”‚                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  ğŸ“Š Views:                                                     â”‚
â”‚  â€¢ user_generation_stats - ç”¨æˆ·ç»Ÿè®¡                           â”‚
â”‚  â€¢ quota_usage_stats - é…é¢ä½¿ç”¨ç»Ÿè®¡                           â”‚
â”‚                                                                â”‚
â”‚  ğŸ”’ RLS ç­–ç•¥:                                                 â”‚
â”‚  â€¢ æ‰€æœ‰è¡¨å¯ç”¨ Row Level Security                              â”‚
â”‚  â€¢ ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®                                     â”‚
â”‚  â€¢ ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰æ•°æ®                                       â”‚
â”‚                                                                â”‚
â”‚  ğŸ“ˆ ç´¢å¼•:                                                     â”‚
â”‚  â€¢ idx_generations_user_id (user_id)                         â”‚
â”‚  â€¢ idx_generations_created_at (created_at DESC)              â”‚
â”‚  â€¢ idx_generations_task_type (task_type)                     â”‚
â”‚  â€¢ idx_favorites_user_id (user_id)                           â”‚
â”‚  â€¢ idx_user_quotas_reset_at (quota_reset_at)                â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹å›¾

### 1. å›¾ç‰‡ç”Ÿæˆæµç¨‹ï¼ˆå®Œæ•´ç‰ˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€‰æ‹©ç”Ÿæˆå‚æ•°      â”‚
â”‚ â€¢ æ¨¡ç‰¹é£æ ¼        â”‚
â”‚ â€¢ æ¨¡ç‰¹å›¾ç‰‡        â”‚
â”‚ â€¢ èƒŒæ™¯å›¾ç‰‡        â”‚
â”‚ â€¢ Vibe æ°›å›´       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‚¹å‡» "Shoot It"  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/quota/reserve                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 1. æ£€æŸ¥ç”¨æˆ·é…é¢æ˜¯å¦è¶³å¤Ÿ                â”‚
â”‚ 2. åˆ›å»º generation è®°å½•ï¼ˆpendingï¼‰     â”‚
â”‚ 3. é¢„ç•™é…é¢ï¼ˆtemporary_used++ï¼‰        â”‚
â”‚ 4. è¿”å› taskId                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/generate                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 1. è®¤è¯æ£€æŸ¥ (requireAuth)              â”‚
â”‚ 2. å›¾ç‰‡æ ¼å¼éªŒè¯                        â”‚
â”‚ 3. è½¬æ¢å›¾ç‰‡ä¸º base64                   â”‚
â”‚                                        â”‚
â”‚ ä¸²è¡Œç”Ÿæˆï¼ˆé¿å… 429 é”™è¯¯ï¼‰:              â”‚
â”‚                                        â”‚
â”‚ Step 1.1: ç”Ÿæˆå•†å“å›¾ 1                 â”‚
â”‚   â€¢ è°ƒç”¨ gemini-3-pro-image-preview   â”‚
â”‚   â€¢ å¤±è´¥é™çº§åˆ° gemini-2.5-flash       â”‚
â”‚   â€¢ å»¶è¿Ÿ 1500ms                       â”‚
â”‚                                        â”‚
â”‚ Step 1.2: ç”Ÿæˆå•†å“å›¾ 2                 â”‚
â”‚   â€¢ åŒä¸Šæµç¨‹                          â”‚
â”‚   â€¢ å»¶è¿Ÿ 1500ms                       â”‚
â”‚                                        â”‚
â”‚ Step 2.1: ç”Ÿæˆæ‹æ‘„æŒ‡å¯¼è¯ 1             â”‚
â”‚   â€¢ ä½¿ç”¨ gemini-3-pro-preview (VLM)   â”‚
â”‚   â€¢ åˆ†æå•†å“å›¾+å‚è€ƒå›¾                  â”‚
â”‚   â€¢ ç”Ÿæˆæ‘„å½±æŒ‡å¯¼                       â”‚
â”‚   â€¢ å»¶è¿Ÿ 1500ms                       â”‚
â”‚                                        â”‚
â”‚ Step 3.1: ç”Ÿæˆæ¨¡ç‰¹å›¾ 1                 â”‚
â”‚   â€¢ ä½¿ç”¨ç”Ÿæˆçš„æŒ‡å¯¼è¯                   â”‚
â”‚   â€¢ è°ƒç”¨å›¾ç‰‡ç”Ÿæˆæ¨¡å‹                   â”‚
â”‚   â€¢ å»¶è¿Ÿ 1500ms                       â”‚
â”‚                                        â”‚
â”‚ Step 2.2: ç”Ÿæˆæ‹æ‘„æŒ‡å¯¼è¯ 2 (æ–°)        â”‚
â”‚   â€¢ é‡æ–°ç”Ÿæˆä¸åŒæŒ‡å¯¼è¯                 â”‚
â”‚   â€¢ å»¶è¿Ÿ 1500ms                       â”‚
â”‚                                        â”‚
â”‚ Step 3.2: ç”Ÿæˆæ¨¡ç‰¹å›¾ 2                 â”‚
â”‚   â€¢ ä½¿ç”¨æ–°æŒ‡å¯¼è¯                       â”‚
â”‚   â€¢ å®Œæˆç”Ÿæˆ                          â”‚
â”‚                                        â”‚
â”‚ 4. ä¸Šä¼ å›¾ç‰‡åˆ° Supabase Storage         â”‚
â”‚    â€¢ å¹¶è¡Œä¸Šä¼  4 å¼ å›¾ç‰‡                 â”‚
â”‚    â€¢ è·å–å…¬å¼€ URL                      â”‚
â”‚                                        â”‚
â”‚ 5. ä¿å­˜åˆ°æ•°æ®åº“                        â”‚
â”‚    â€¢ æ›´æ–° generation è®°å½•             â”‚
â”‚    â€¢ status = 'completed'             â”‚
â”‚    â€¢ è®°å½•ç”Ÿæˆæ—¶é•¿ã€æ¨¡å‹ç±»å‹            â”‚
â”‚                                        â”‚
â”‚ 6. è¿”å›ç»“æœ                            â”‚
â”‚    â€¢ images: [url1, url2, url3, url4] â”‚
â”‚    â€¢ modelTypes: ['pro', 'flash', ...]â”‚
â”‚    â€¢ generationId                     â”‚
â”‚    â€¢ stats                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯æ˜¾ç¤ºç»“æœ                           â”‚
â”‚ â€¢ æ˜¾ç¤º 4 å¼ ç”Ÿæˆçš„å›¾ç‰‡                  â”‚
â”‚ â€¢ æä¾›ä¸‹è½½ã€æ”¶è—æŒ‰é’®                   â”‚
â”‚ â€¢ å¯é‡æ–°ç”Ÿæˆ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. é…é¢ç³»ç»Ÿæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é…é¢ç®¡ç†æµç¨‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ç”¨æˆ·æ³¨å†Œ                                                    â”‚
â”‚     â†“                                                        â”‚
â”‚  è‡ªåŠ¨åˆ†é…åˆå§‹é…é¢                                            â”‚
â”‚     â€¢ daily_quota = 10                                      â”‚
â”‚     â€¢ monthly_quota = 100                                   â”‚
â”‚     â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ç”¨æˆ·è¯·æ±‚ç”Ÿæˆ                                 â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ POST /api/quota/reserve                     â”‚           â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚           â”‚
â”‚  â”‚ 1. SELECT * FROM user_quotas                â”‚           â”‚
â”‚  â”‚    WHERE user_id = $1                       â”‚           â”‚
â”‚  â”‚                                              â”‚           â”‚
â”‚  â”‚ 2. æ£€æŸ¥é…é¢                                  â”‚           â”‚
â”‚  â”‚    â€¢ used_quota_today < daily_quota?        â”‚           â”‚
â”‚  â”‚    â€¢ used_quota_month < monthly_quota?      â”‚           â”‚
â”‚  â”‚                                              â”‚           â”‚
â”‚  â”‚ 3. å¦‚æœä¸è¶³:                                 â”‚           â”‚
â”‚  â”‚    â€¢ è¿”å› { insufficient: true }            â”‚           â”‚
â”‚  â”‚    â€¢ å‰ç«¯æ˜¾ç¤º"é…é¢ä¸è¶³"æç¤º                  â”‚           â”‚
â”‚  â”‚                                              â”‚           â”‚
â”‚  â”‚ 4. å¦‚æœè¶³å¤Ÿ:                                 â”‚           â”‚
â”‚  â”‚    â€¢ åˆ›å»º generation è®°å½• (pending)         â”‚           â”‚
â”‚  â”‚    â€¢ é¢„ç•™é…é¢ (ä¸´æ—¶æ ‡è®°)                    â”‚           â”‚
â”‚  â”‚    â€¢ è¿”å› taskId                            â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ å¼€å§‹ç”Ÿæˆ                                     â”‚           â”‚
â”‚  â”‚ â€¢ æˆåŠŸ: æ­£å¼æ‰£é™¤é…é¢                         â”‚           â”‚
â”‚  â”‚   UPDATE user_quotas                        â”‚           â”‚
â”‚  â”‚   SET used_quota_today = used_quota_today+nâ”‚           â”‚
â”‚  â”‚       used_quota_month = used_quota_month+nâ”‚           â”‚
â”‚  â”‚                                              â”‚           â”‚
â”‚  â”‚ â€¢ å¤±è´¥: é‡Šæ”¾é¢„ç•™é…é¢                         â”‚           â”‚
â”‚  â”‚   (è‡ªåŠ¨å›æ»š)                                 â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ é…é¢é‡ç½® (Cron Job)                          â”‚           â”‚
â”‚  â”‚ â€¢ æ¯æ—¥ 0:00 é‡ç½® used_quota_today = 0       â”‚           â”‚
â”‚  â”‚ â€¢ æ¯æœˆ 1 æ—¥é‡ç½® used_quota_month = 0        â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ é…é¢ç”³è¯·æµç¨‹                                 â”‚           â”‚
â”‚  â”‚ 1. ç”¨æˆ·æäº¤ç”³è¯· (reason, requested_quota)   â”‚           â”‚
â”‚  â”‚ 2. ç®¡ç†å‘˜å®¡æ ¸                                â”‚           â”‚
â”‚  â”‚ 3. æ‰¹å‡†åè‡ªåŠ¨å¢åŠ ç”¨æˆ·é…é¢                    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. è®¤è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è®¤è¯æµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Method 1: é‚®ç®±ç™»å½•                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  1. ç”¨æˆ·è¾“å…¥é‚®ç®±                                             â”‚
â”‚  2. Supabase å‘é€ Magic Link                                â”‚
â”‚  3. ç”¨æˆ·ç‚¹å‡»é‚®ä»¶é“¾æ¥                                         â”‚
â”‚  4. è·³è½¬åˆ° /auth/callback                                    â”‚
â”‚  5. åˆ›å»º Session                                            â”‚
â”‚  6. é‡å®šå‘åˆ°åº”ç”¨                                             â”‚
â”‚                                                             â”‚
â”‚  Method 2: æ‰‹æœºå·ç™»å½•                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  1. ç”¨æˆ·è¾“å…¥æ‰‹æœºå·                                           â”‚
â”‚  2. POST /api/sms/send                                      â”‚
â”‚     â€¢ è°ƒç”¨é˜¿é‡Œäº‘çŸ­ä¿¡ API                                     â”‚
â”‚     â€¢ å‘é€éªŒè¯ç                                              â”‚
â”‚     â€¢ ä¿å­˜åˆ° sms_codes è¡¨                                   â”‚
â”‚  3. ç”¨æˆ·è¾“å…¥éªŒè¯ç                                            â”‚
â”‚  4. POST /api/sms/verify                                    â”‚
â”‚     â€¢ éªŒè¯ç æ ¡éªŒ                                             â”‚
â”‚     â€¢ è‡ªåŠ¨åˆ›å»º/ç™»å½•ç”¨æˆ·                                      â”‚
â”‚     â€¢ åˆ›å»º Session                                          â”‚
â”‚  5. è¿”å› JWT Token                                          â”‚
â”‚                                                             â”‚
â”‚  Method 3: Google OAuth                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  1. ç”¨æˆ·ç‚¹å‡» "Google ç™»å½•"                                   â”‚
â”‚  2. è·³è½¬åˆ° Google æˆæƒé¡µ                                     â”‚
â”‚  3. ç”¨æˆ·æˆæƒ                                                 â”‚
â”‚  4. å›è°ƒåˆ° /auth/callback                                    â”‚
â”‚  5. Supabase è‡ªåŠ¨åˆ›å»ºç”¨æˆ·                                    â”‚
â”‚  6. é‡å®šå‘åˆ°åº”ç”¨                                             â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                             â”‚
â”‚  Middleware ä¿æŠ¤è·¯ç”±                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  æ¯ä¸ªè¯·æ±‚:                                                   â”‚
â”‚  1. middleware.ts æ‹¦æˆª                                       â”‚
â”‚  2. æ£€æŸ¥ Cookie ä¸­çš„ Session                                â”‚
â”‚  3. è°ƒç”¨ supabase.auth.getSession()                         â”‚
â”‚  4. å¦‚æœæœªç™»å½• + è®¿é—®ä¿æŠ¤è·¯ç”±:                               â”‚
â”‚     â€¢ é‡å®šå‘åˆ° /login                                        â”‚
â”‚  5. å¦‚æœå·²ç™»å½•:                                              â”‚
â”‚     â€¢ ç»§ç»­è¯·æ±‚                                               â”‚
â”‚     â€¢ æ³¨å…¥ user ä¿¡æ¯åˆ° context                               â”‚
â”‚                                                             â”‚
â”‚  API è®¤è¯                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  æ”¯æŒä¸¤ç§æ–¹å¼:                                               â”‚
â”‚  1. Cookie Session (æµè§ˆå™¨)                                 â”‚
â”‚  2. Bearer Token (API è°ƒç”¨)                                 â”‚
â”‚                                                             â”‚
â”‚  // lib/auth.ts                                            â”‚
â”‚  export async function requireAuth(request) {              â”‚
â”‚    // 1. å°è¯•ä» Cookie è·å–                                 â”‚
â”‚    const supabase = createServerClient(request)            â”‚
â”‚    const { data: { user } } = await supabase.auth.getUser()â”‚
â”‚                                                             â”‚
â”‚    // 2. å°è¯•ä» Authorization Header è·å–                   â”‚
â”‚    if (!user) {                                            â”‚
â”‚      const token = request.headers.get('Authorization')    â”‚
â”‚      // éªŒè¯ JWT Token                                      â”‚
â”‚    }                                                        â”‚
â”‚                                                             â”‚
â”‚    if (!user) {                                            â”‚
â”‚      return { response: 401 Unauthorized }                â”‚
â”‚    }                                                        â”‚
â”‚    return { user }                                         â”‚
â”‚  }                                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ çŠ¶æ€ç®¡ç†æ¶æ„ï¼ˆZustandï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Zustand Store æ¶æ„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ cameraStore (ç›¸æœºçŠ¶æ€)                                 â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚ State:                                                 â”‚ â”‚
â”‚  â”‚   â€¢ capturedImage: string | null                      â”‚ â”‚
â”‚  â”‚   â€¢ selectedModel: Asset | null                       â”‚ â”‚
â”‚  â”‚   â€¢ selectedBackground: Asset | null                  â”‚ â”‚
â”‚  â”‚   â€¢ selectedVibe: Asset | null                        â”‚ â”‚
â”‚  â”‚   â€¢ modelStyle: 'korean' | 'western' | 'auto'        â”‚ â”‚
â”‚  â”‚   â€¢ isGenerating: boolean                             â”‚ â”‚
â”‚  â”‚   â€¢ generatedImages: string[]                         â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Actions:                                               â”‚ â”‚
â”‚  â”‚   â€¢ setCapturedImage()                                â”‚ â”‚
â”‚  â”‚   â€¢ setSelectedModel()                                â”‚ â”‚
â”‚  â”‚   â€¢ setModelStyle()                                   â”‚ â”‚
â”‚  â”‚   â€¢ reset()                                           â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Persistence: IndexedDB âœ…                             â”‚ â”‚
â”‚  â”‚   â€¢ åªæŒä¹…åŒ–é€‰æ‹©çŠ¶æ€                                   â”‚ â”‚
â”‚  â”‚   â€¢ ä¸æŒä¹…åŒ–å›¾ç‰‡æ•°æ®ï¼ˆé¿å…å¤§å¯¹è±¡ï¼‰                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ assetStore (èµ„äº§çŠ¶æ€)                                  â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚ State:                                                 â”‚ â”‚
â”‚  â”‚   â€¢ models: Asset[]                                   â”‚ â”‚
â”‚  â”‚   â€¢ backgrounds: Asset[]                              â”‚ â”‚
â”‚  â”‚   â€¢ vibes: Asset[]                                    â”‚ â”‚
â”‚  â”‚   â€¢ isLoading: boolean                                â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Actions:                                               â”‚ â”‚
â”‚  â”‚   â€¢ fetchAssets(type)                                 â”‚ â”‚
â”‚  â”‚   â€¢ addAsset()                                        â”‚ â”‚
â”‚  â”‚   â€¢ deleteAsset()                                     â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Persistence: IndexedDB âœ…                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ generationTaskStore (ä»»åŠ¡çŠ¶æ€)                         â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚ State:                                                 â”‚ â”‚
â”‚  â”‚   â€¢ tasks: Map<taskId, Task>                          â”‚ â”‚
â”‚  â”‚   â€¢ currentTaskId: string | null                      â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Task:                                                  â”‚ â”‚
â”‚  â”‚   â€¢ taskId: string                                    â”‚ â”‚
â”‚  â”‚   â€¢ status: 'pending' | 'processing' | 'completed'   â”‚ â”‚
â”‚  â”‚   â€¢ progress: number (0-100)                          â”‚ â”‚
â”‚  â”‚   â€¢ images: string[]                                  â”‚ â”‚
â”‚  â”‚   â€¢ error?: string                                    â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Actions:                                               â”‚ â”‚
â”‚  â”‚   â€¢ createTask()                                      â”‚ â”‚
â”‚  â”‚   â€¢ updateTaskProgress()                              â”‚ â”‚
â”‚  â”‚   â€¢ completeTask()                                    â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Persistence: None (ä¸´æ—¶çŠ¶æ€)                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ languageStore (è¯­è¨€çŠ¶æ€)                               â”‚ â”‚
â”‚  â”‚ presetStore (é¢„è®¾çŠ¶æ€)                                 â”‚ â”‚
â”‚  â”‚ settingsStore (è®¾ç½®çŠ¶æ€)                               â”‚ â”‚
â”‚  â”‚ ...                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  IndexedDB Storage:                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚  Database: brand-camera-storage                            â”‚
â”‚  Stores:                                                   â”‚
â”‚    â€¢ camera-storage (ç›¸æœºçŠ¶æ€)                             â”‚
â”‚    â€¢ asset-storage (èµ„äº§çŠ¶æ€)                              â”‚
â”‚    â€¢ ...                                                   â”‚
â”‚                                                             â”‚
â”‚  ä¼˜ç‚¹:                                                      â”‚
â”‚    âœ… å®¹é‡å¤§ï¼ˆå‡ ç™¾ MBï¼‰                                     â”‚
â”‚    âœ… å¼‚æ­¥æ“ä½œä¸é˜»å¡ä¸»çº¿ç¨‹                                  â”‚
â”‚    âœ… æ”¯æŒå¤æ‚æ•°æ®ç»“æ„                                      â”‚
â”‚    âœ… ç¦»çº¿å¯ç”¨                                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¤– Gemini API è°ƒç”¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Gemini API é›†æˆæ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ lib/genai.ts (API å°è£…å±‚)                              â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ // å•ä¾‹æ¨¡å¼                                            â”‚ â”‚
â”‚  â”‚ let genAIClient: GoogleGenAI | null = null             â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ export function getGenAIClient() {                     â”‚ â”‚
â”‚  â”‚   if (!genAIClient) {                                 â”‚ â”‚
â”‚  â”‚     genAIClient = new GoogleGenAI({                   â”‚ â”‚
â”‚  â”‚       apiKey: process.env.GEMINI_API_KEY             â”‚ â”‚
â”‚  â”‚     })                                                 â”‚ â”‚
â”‚  â”‚   }                                                    â”‚ â”‚
â”‚  â”‚   return genAIClient                                  â”‚ â”‚
â”‚  â”‚ }                                                      â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ // å®‰å…¨è®¾ç½®ï¼ˆç¦ç”¨æ‰€æœ‰è¿‡æ»¤ï¼‰                             â”‚ â”‚
â”‚  â”‚ export const safetySettings = [                       â”‚ â”‚
â”‚  â”‚   { category: HARASSMENT, threshold: BLOCK_NONE }    â”‚ â”‚
â”‚  â”‚   { category: HATE_SPEECH, threshold: BLOCK_NONE }   â”‚ â”‚
â”‚  â”‚   ...                                                  â”‚ â”‚
â”‚  â”‚ ]                                                      â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ // è¾…åŠ©å‡½æ•°                                            â”‚ â”‚
â”‚  â”‚ export function extractImage(response) { ... }        â”‚ â”‚
â”‚  â”‚ export function extractText(response) { ... }         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ API è·¯ç”±è°ƒç”¨æµç¨‹                                       â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 1. è·å–å®¢æˆ·ç«¯                                          â”‚ â”‚
â”‚  â”‚    const client = getGenAIClient()                    â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 2. å‡†å¤‡è¯·æ±‚ parts                                      â”‚ â”‚
â”‚  â”‚    const parts = [                                     â”‚ â”‚
â”‚  â”‚      { text: prompt },                                â”‚ â”‚
â”‚  â”‚      { inlineData: { mimeType, data: base64 } }       â”‚ â”‚
â”‚  â”‚    ]                                                   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 3. è°ƒç”¨ä¸»æ¨¡å‹ï¼ˆProï¼‰                                   â”‚ â”‚
â”‚  â”‚    try {                                              â”‚ â”‚
â”‚  â”‚      const response = await client.models             â”‚ â”‚
â”‚  â”‚        .generateContent({                             â”‚ â”‚
â”‚  â”‚          model: 'gemini-3-pro-image-preview',         â”‚ â”‚
â”‚  â”‚          contents: [{ role: 'user', parts }],        â”‚ â”‚
â”‚  â”‚          config: {                                    â”‚ â”‚
â”‚  â”‚            responseModalities: ['IMAGE'],            â”‚ â”‚
â”‚  â”‚            safetySettings,                            â”‚ â”‚
â”‚  â”‚          }                                            â”‚ â”‚
â”‚  â”‚        })                                             â”‚ â”‚
â”‚  â”‚      return extractImage(response)                    â”‚ â”‚
â”‚  â”‚    } catch (error) {                                  â”‚ â”‚
â”‚  â”‚      // é™çº§åˆ° Flash æ¨¡å‹                              â”‚ â”‚
â”‚  â”‚    }                                                   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 4. é™çº§æ¨¡å‹ï¼ˆFlashï¼‰                                   â”‚ â”‚
â”‚  â”‚    const fallbackResponse = await client.models       â”‚ â”‚
â”‚  â”‚      .generateContent({                               â”‚ â”‚
â”‚  â”‚        model: 'gemini-2.5-flash-image',               â”‚ â”‚
â”‚  â”‚        ...                                            â”‚ â”‚
â”‚  â”‚      })                                               â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 5. æå–ç»“æœ                                            â”‚ â”‚
â”‚  â”‚    const image = extractImage(response)               â”‚ â”‚
â”‚  â”‚    return `data:image/png;base64,${image}`           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ¨¡å‹é€‰æ‹©ç­–ç•¥                                           â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Primary Model: gemini-3-pro-image-preview â­          â”‚ â”‚
â”‚  â”‚   â€¢ é«˜è´¨é‡å›¾ç‰‡ç”Ÿæˆ                                     â”‚ â”‚
â”‚  â”‚   â€¢ æ›´å¥½çš„ç»†èŠ‚å’Œè‰²å½©                                   â”‚ â”‚
â”‚  â”‚   â€¢ æ›´æ…¢ï¼ˆ30-60ç§’/å¼ ï¼‰                                â”‚ â”‚
â”‚  â”‚   â€¢ å¯èƒ½è§¦å‘ 429 é”™è¯¯                                  â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Fallback Model: gemini-2.5-flash-image ğŸš€             â”‚ â”‚
â”‚  â”‚   â€¢ å¿«é€Ÿç”Ÿæˆ                                           â”‚ â”‚
â”‚  â”‚   â€¢ è´¨é‡ç•¥ä½ä½†å¯æ¥å—                                   â”‚ â”‚
â”‚  â”‚   â€¢ æ›´ç¨³å®š                                             â”‚ â”‚
â”‚  â”‚   â€¢ ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ                                       â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ VLM Model: gemini-3-pro-preview ğŸ‘ï¸                   â”‚ â”‚
â”‚  â”‚   â€¢ å¤šæ¨¡æ€ç†è§£ï¼ˆå›¾ç‰‡â†’æ–‡æœ¬ï¼‰                            â”‚ â”‚
â”‚  â”‚   â€¢ ç”¨äºç”Ÿæˆæ‹æ‘„æŒ‡å¯¼è¯                                 â”‚ â”‚
â”‚  â”‚   â€¢ åˆ†æå•†å“ç‰¹å¾                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ é”™è¯¯å¤„ç†å’Œé‡è¯•                                         â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 1. 429 é”™è¯¯æ£€æµ‹                                        â”‚ â”‚
â”‚  â”‚    function isRateLimitError(error) {                 â”‚ â”‚
â”‚  â”‚      return error.message.includes('429')             â”‚ â”‚
â”‚  â”‚          || error.message.includes('rate')            â”‚ â”‚
â”‚  â”‚          || error.message.includes('quota')           â”‚ â”‚
â”‚  â”‚    }                                                   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 2. ä¸²è¡Œç”Ÿæˆï¼ˆé¿å…å¹¶å‘ 429ï¼‰                            â”‚ â”‚
â”‚  â”‚    const BATCH_DELAY_MS = 1500                        â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚    // ç”Ÿæˆå›¾ç‰‡ 1                                       â”‚ â”‚
â”‚  â”‚    const img1 = await generate()                      â”‚ â”‚
â”‚  â”‚    await delay(BATCH_DELAY_MS) // ç­‰å¾… 1.5 ç§’         â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚    // ç”Ÿæˆå›¾ç‰‡ 2                                       â”‚ â”‚
â”‚  â”‚    const img2 = await generate()                      â”‚ â”‚
â”‚  â”‚    ...                                                 â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 3. è‡ªåŠ¨é™çº§                                            â”‚ â”‚
â”‚  â”‚    â€¢ Pro å¤±è´¥ â†’ ç«‹å³å°è¯• Flash                         â”‚ â”‚
â”‚  â”‚    â€¢ ä¸é‡è¯• Proï¼ˆé¿å…æµªè´¹æ—¶é—´ï¼‰                        â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ 4. æ—¥å¿—è®°å½•                                            â”‚ â”‚
â”‚  â”‚    console.log('[Label] Message')                     â”‚ â”‚
â”‚  â”‚    â€¢ [Product 1] Trying gemini-3-pro...               â”‚ â”‚
â”‚  â”‚    â€¢ [Product 1] gemini-3-pro succeeded in 35000ms   â”‚ â”‚
â”‚  â”‚    â€¢ [Model 1] Trying fallback gemini-2.5-flash...   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ éƒ¨ç½²æ¶æ„ï¼ˆVercel + Supabaseï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        éƒ¨ç½²æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Vercel Platform                                        â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Edge Network (å…¨çƒ CDN)                          â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ é™æ€èµ„æºç¼“å­˜                                    â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ Gzip/Brotli å‹ç¼©                               â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ è‡ªåŠ¨ HTTPS                                     â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Next.js App (SSR + SSG)                          â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ React Server Components                        â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ App Router                                     â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ é™æ€é¡µé¢ç”Ÿæˆ                                    â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Serverless Functions                             â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ 30 ä¸ª API è·¯ç”±                                 â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ maxDuration: 300s (5 åˆ†é’Ÿ)                    â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ è‡ªåŠ¨æ‰©ç¼©å®¹                                      â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ é›¶è¿ç»´                                          â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Vercel Analytics                                 â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ ç”¨æˆ·è®¿é—®ç»Ÿè®¡                                    â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ æ€§èƒ½ç›‘æ§                                        â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ é”™è¯¯è¿½è¸ª                                        â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ Environment Variables:                                 â”‚ â”‚
â”‚  â”‚   â€¢ GEMINI_API_KEY                                    â”‚ â”‚
â”‚  â”‚   â€¢ NEXT_PUBLIC_SUPABASE_URL                          â”‚ â”‚
â”‚  â”‚   â€¢ SUPABASE_SERVICE_ROLE_KEY                         â”‚ â”‚
â”‚  â”‚   â€¢ ADMIN_EMAILS                                      â”‚ â”‚
â”‚  â”‚   â€¢ ALIYUN_ACCESS_KEY_ID                              â”‚ â”‚
â”‚  â”‚   â€¢ ...                                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Supabase Platform                                      â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ PostgreSQL Database                              â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ 11 ä¸ªæ•°æ®è¡¨                                     â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ RLS å®‰å…¨ç­–ç•¥                                    â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ è‡ªåŠ¨å¤‡ä»½                                        â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ Connection Pooling                             â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Storage (å›¾ç‰‡å­˜å‚¨)                                â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ generations bucket                             â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ presets bucket                                 â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ è‡ªåŠ¨ CDN åŠ é€Ÿ                                   â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ å‹ç¼©å’Œä¼˜åŒ–                                      â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Auth (è®¤è¯)                                       â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ Email / Password                               â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ Google OAuth                                   â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ æ‰‹æœºå·ç™»å½•ï¼ˆé˜¿é‡Œäº‘çŸ­ä¿¡ï¼‰                         â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ JWT Token                                      â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Realtime (å®æ—¶è®¢é˜…)                               â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ WebSocket è¿æ¥                                  â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ æ•°æ®åº“å˜æ›´æ¨é€                                  â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ åœ¨çº¿çŠ¶æ€                                        â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Google Cloud Platform                                  â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ Vertex AI (Gemini API)                           â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ gemini-3-pro-image-preview                     â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ gemini-2.5-flash-image                         â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ gemini-3-pro-preview (VLM)                     â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ API Key è®¤è¯                                    â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ è‡ªåŠ¨é™æµç®¡ç†                                    â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Aliyun (é˜¿é‡Œäº‘)                                        â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ SMS Service (çŸ­ä¿¡æœåŠ¡)                            â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ éªŒè¯ç å‘é€                                      â”‚   â”‚ â”‚
â”‚  â”‚ â”‚ â€¢ æ‰‹æœºå·ç™»å½•                                      â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  éƒ¨ç½²æµç¨‹:                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  1. Git Push â†’ Vercel è‡ªåŠ¨æ„å»º                             â”‚
â”‚  2. ç¯å¢ƒå˜é‡æ³¨å…¥                                            â”‚
â”‚  3. Next.js Build                                           â”‚
â”‚  4. éƒ¨ç½²åˆ°å…¨çƒ Edge Network                                 â”‚
â”‚  5. å¥åº·æ£€æŸ¥                                                â”‚
â”‚  6. åˆ‡æ¢æµé‡                                                â”‚
â”‚                                                             â”‚
â”‚  æ€§èƒ½ä¼˜åŒ–:                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  â€¢ Edge Functions (é™ä½å»¶è¿Ÿ)                               â”‚
â”‚  â€¢ ISR (Incremental Static Regeneration)                   â”‚
â”‚  â€¢ Image Optimization (è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–)                        â”‚
â”‚  â€¢ CDN Caching                                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*ç³»ç»Ÿæ¶æ„å›¾æ–‡æ¡£ | æœ€åæ›´æ–°: 2025-12-14*
