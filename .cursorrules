# Brand Camera é¡¹ç›®å¼€å‘è§„åˆ™

## æ–°åŠŸèƒ½å¼€å‘æ£€æŸ¥æ¸…å•

æ¯æ¬¡å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œå¿…é¡»æ£€æŸ¥ä»¥ä¸‹æ¨¡å—æ˜¯å¦éœ€è¦åŒæ­¥ä¿®æ”¹ï¼š

### 1. ğŸ’° è®¡è´¹ç³»ç»Ÿ
- [ ] `src/app/api/quota/reserve/route.ts` - æ‰£è´¹é€»è¾‘
- [ ] `src/lib/taskTypes.ts` - ä»»åŠ¡ç±»å‹å®šä¹‰ï¼ˆæ–°å¢ç±»å‹éœ€è¦åœ¨è¿™é‡Œæ³¨å†Œï¼‰
- [ ] ç¡®è®¤ credit æ¶ˆè€—è§„åˆ™ï¼ˆå›¾ç‰‡ 1 creditï¼Œè§†é¢‘ 10 creditsï¼‰

### 2. ğŸ“¦ èµ„äº§ç®¡ç†
- [ ] `src/app/api/gallery/route.ts` - Gallery API è¿‡æ»¤é€»è¾‘ï¼ˆæ–° task_type éœ€è¦æ·»åŠ è¿‡æ»¤æ¡ä»¶ï¼‰
- [ ] `src/app/(main)/gallery/page.tsx` - Gallery é¡µé¢ tab æ˜¾ç¤º
- [ ] `src/components/shared/GalleryPreloader.tsx` - é¢„åŠ è½½é…ç½®
- [ ] æ•°æ®åº“ `generations` è¡¨å­—æ®µï¼š`output_image_urls`ï¼ˆä¸æ˜¯ `image_urls`ï¼‰

### 3. ğŸ¨ UI ä¸€è‡´æ€§
- [ ] ä½¿ç”¨ `useIsDesktop` hook + `ScreenLoadingGuard` ç»„ä»¶é˜²æ­¢é¡µé¢é—ªçƒ
- [ ] PC Web å’Œ Mobile Web åŒç«¯é€‚é…
- [ ] åº•éƒ¨å¯¼èˆª `BottomNav` ä»…åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤º
- [ ] ç›¸æœºåŠŸèƒ½ä»…åœ¨ç§»åŠ¨ç«¯å¯ç”¨

### 4. ğŸŒ å›½é™…åŒ–
- [ ] `src/locales/zh.ts` - ä¸­æ–‡ç¿»è¯‘
- [ ] `src/locales/en.ts` - è‹±æ–‡ç¿»è¯‘  
- [ ] `src/locales/ko.ts` - éŸ©æ–‡ç¿»è¯‘
- [ ] AI ç”Ÿæˆçš„æ–‡æœ¬éœ€è¦æ ¹æ®ç”¨æˆ·è¯­è¨€è®¾ç½®ç”Ÿæˆå¯¹åº”è¯­è¨€

### 5. ğŸ§­ å¯¼èˆª
- [ ] `src/components/layouts/Sidebar.tsx` - PC ç«¯ä¾§è¾¹æ 
- [ ] é¦–é¡µå…¥å£å¡ç‰‡ `src/app/(main)/app/page.tsx`
- [ ] è·¯ç”±ï¼šåŠŸèƒ½é¡µé¢æ”¾åœ¨ `src/app/(main)/` ä¸‹

### 6. ğŸ” è®¤è¯
- [ ] é¡µé¢éœ€è¦ç™»å½•æ£€æŸ¥
- [ ] API è·¯ç”±ä½¿ç”¨ `requireAuth()` ä¸­é—´ä»¶

### 7. ğŸ“ æ•°æ®å­˜å‚¨
- [ ] ç”Ÿæˆç»“æœä¿å­˜åˆ° `generations` è¡¨
- [ ] ä½¿ç”¨ `task_type` å­—æ®µåŒºåˆ†åŠŸèƒ½ç±»å‹
- [ ] å›¾ç‰‡ä¸Šä¼ åˆ° Supabase Storage `generations` bucket

---

## é¡¹ç›®æ¶æ„æ¦‚è§ˆ

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx              # Landing Page (æœªç™»å½•)
â”‚   â”œâ”€â”€ (main)/               # éœ€è¦ç™»å½•çš„é¡µé¢
â”‚   â”‚   â”œâ”€â”€ app/page.tsx      # App é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ gallery/          # ä½œå“é›†
â”‚   â”‚   â”œâ”€â”€ brand-style/      # Clone Brand Style
â”‚   â”‚   â”œâ”€â”€ camera/           # æ‹ç…§åŠŸèƒ½
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ api/                  # API è·¯ç”±
â”‚       â”œâ”€â”€ quota/            # è®¡è´¹
â”‚       â”œâ”€â”€ gallery/          # ä½œå“é›†
â”‚       â””â”€â”€ brand-style/      # Brand Style APIs
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ layouts/              # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ shared/               # å…±äº«ç»„ä»¶
â”‚   â””â”€â”€ ui/                   # UI ç»„ä»¶
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ taskTypes.ts          # ä»»åŠ¡ç±»å‹å®šä¹‰ï¼ˆé‡è¦ï¼ï¼‰
â”œâ”€â”€ stores/                   # Zustand çŠ¶æ€ç®¡ç†
â””â”€â”€ locales/                  # å›½é™…åŒ–
```

## ä»»åŠ¡ç±»å‹æ³¨å†Œæµç¨‹

æ–°å¢åŠŸèƒ½ç±»å‹æ—¶ï¼Œå¿…é¡»åœ¨ä»¥ä¸‹ä½ç½®æ³¨å†Œï¼š

1. **`src/lib/taskTypes.ts`**
```typescript
export const TaskTypes = {
  // ... existing
  NEW_TYPE: 'new_type',
} as const

// æ·»åŠ åˆ¤æ–­å‡½æ•°
export function isNewType(type?: string): boolean {
  return getCanonicalType(type) === TaskTypes.NEW_TYPE
}
```

2. **`src/app/api/gallery/route.ts`** - æ·»åŠ è¿‡æ»¤æ¡ä»¶
```typescript
} else if (type === 'newtab') {
  query = query.or('task_type.eq.new_type')
}
```

3. **`src/app/(main)/gallery/page.tsx`** - æ·»åŠ  tabï¼ˆå¦‚éœ€è¦ï¼‰

---

## å¸¸è§é—®é¢˜

### Q: å›¾ç‰‡åœ¨ Gallery ä¸­ä¸æ˜¾ç¤ºï¼Ÿ
æ£€æŸ¥ï¼š
1. ä¿å­˜æ—¶ä½¿ç”¨ `output_image_urls` å­—æ®µï¼ˆä¸æ˜¯ `image_urls`ï¼‰
2. `task_type` å·²åœ¨ `gallery/route.ts` ä¸­æ·»åŠ è¿‡æ»¤æ¡ä»¶
3. GalleryPreloader ä¸­åŒ…å«è¯¥ tab

### Q: é¡µé¢è¿›å…¥æ—¶é—ªçƒ/åˆ·æ–°ï¼Ÿ
ä½¿ç”¨ `useIsDesktop` + `ScreenLoadingGuard`ï¼š
```tsx
const { isDesktop } = useIsDesktop()
return (
  <ScreenLoadingGuard>
    {/* é¡µé¢å†…å®¹ */}
  </ScreenLoadingGuard>
)
```

### Q: åˆ‡æ¢ tab æ—¶é‡æ–°è¯·æ±‚ï¼Ÿ
æ£€æŸ¥ `GalleryPreloader.tsx` æ˜¯å¦åŒ…å«è¯¥ tab çš„é¢„åŠ è½½é…ç½®
